<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">

        <link rel="stylesheet" href="css/bootstrap.min.css">

        <!--        <link rel="stylesheet" href="css/bootstrap-responsive.min.css">-->
        <link rel="stylesheet" href="js/colorpicker2/css/bootstrap-colorpicker.css">
        <!-- link href="http://netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet" -->
        <link href="css/font-awesome.min.css" rel="stylesheet" />
        <link rel="stylesheet" href="css/main.css">
        <script src="js/vendor/modernizr-2.6.2-respond-1.1.0.min.js"></script>

        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
    </head>
    <body>
        <!--[if lt IE 9]>
            <p class="chromeframe">You are using an <strong><i>NO SUPPORTED</i></strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser, we recommand ie9+, google chrome, firefox, safari and opera latest version</a></p>
        <![endif]-->

        <!-- This code is taken from http://twitter.github.com/bootstrap/examples/hero.html -->

        <div class="navbar navbar-fixed-top navbar-inverse">
            <div class="navbar-inner">
                <div class="container">
                    <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </a>
                    <a class="brand" href="#" style="margin-left:5px;">Online DIY maker</a>

                    <div class="nav-collapse collapse">
                        <ul class="nav">
                            <li class="active"><a href="index.html">Home</a></li>
                        </ul>
                    </div><!--/.nav-collapse -->
                    <ul class="nav" role="navigation">
                        <li class="dropdown">
                            <a id="drop1" href="#" role="button" class="dropdown-toggle" data-toggle="dropdown">Gallery <b class="caret"></b></a>
                            <ul class="dropdown-menu" role="menu" aria-labelledby="drop1">
                                <li role="presentation"><a role="menuitem" tabindex="-1" href="http://google.com">Quick</a></li>  
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <!-- content -->
        <div class="container unselectable" id="box-container">
            <div class="row-fluid" style="height:70px;">
                <div class="span6">
                    <h5 style="padding:0px;margin:0px;">Click the text and images to personalise your business card.</h5>
                    <div style="font-size:13px;line-height: 15px;">
                        (You can add new images and text areas by dragging and dropping the image and text icons to the right onto your business card)
                    </div>
                </div>
                <div class="span6">
                    <div class="pull-right tools" id="box-toolbar-main">
                        <ul class="thumbnails">
                            <li>
                                <div class="thumbnail" style="border:none;text-align:center;margin:auto;">
                                    <a href="javascript:" class="thumbnail" data-action="background" style="border:none;text-shadow: none;box-shadow: none;color:red"><i class="icon-desktop icon-2x"></i></a>
                                    <div class="caption">
                                        Background
                                    </div>
                                </div>
                            </li>
                            <li>
                                <div class="thumbnail" style="border:none;text-align:center;margin:auto;">
                                    <a href="javascript:" class="thumbnail" data-action="addgrid" style="border:none;text-shadow: none;box-shadow: none;"><i class="icon-building icon-2x"></i></a>
                                    <div class="caption">
                                        Snap to grid
                                    </div>
                                </div>
                            </li>
                            <li>
                                <div class="thumbnail" style="border:none;text-align:center;margin:auto;">
                                    <a href="javascript:" class="thumbnail" data-action="addtext" title="add text" style="border:none;text-shadow: none;box-shadow: none;"><i class="icon-font icon-2x"></i></a>
                                    <div class="caption">
                                        Add text
                                    </div>
                                </div>
                            </li>
                            <li>
                                <div class="thumbnail" style="border:none;text-align:center;margin:auto;" id="uploader">
                                    <a href="javascript:" class="thumbnail" id="btn-upload-image" style="border:none;text-shadow: none;box-shadow: none;"><i class="icon-picture icon-2x"></i></a>
                                    <div class="caption">
                                        Add image
                                    </div>
                                </div>
                            </li>
                            <li>
                                <div class="thumbnail" style="border:none;text-align:center;margin:auto;">
                                    <a href="javascript:" class="thumbnail" style="border:none;text-shadow: none;box-shadow: none;"><i class="icon-th-large icon-2x"></i></a>
                                    <div class="caption">
                                        Add shape
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div style="height:1px;background-color:#ccc"></div>
            <div class="row-fluid" style="height:40px;">
                <div class="span6">
                   
                </div>
                <div class="span6">
                    
                </div>
            </div>
            <!-- canvas -->
            <input type="hidden" id="current-item" style="display:none;" />
            <input type="hidden" name="canvas_guid" id="canvas_guid" style="display:none;" value="" data-reload="" />
            <div class="row-fluid" id="box-editing">
                <div class="span12" style="padding:10px;overflow:auto;width:100%;">
                    <div class="clear"></div>
                    <div class="row-fluid" style="width:914px;height:100px;position:absolute;margin:0px;padding:0px;">
                        <div class="tools unselectable pull-right" id="box-toolbar-move" style="margin-right:10px;">
                            <ul>
                                <li></li>
                                <li>
                                    <a href="javascript:" data-action="moveup">
                                        <i class="icon-arrow-up icon-2x"></i>
                                    </a>
                                </li>
                                <li></li>
                                <li>
                                    <a href="javascript:" data-action="moveleft" class="pull-left">
                                        <i class="icon-arrow-left icon-2x"></i>
                                    </a>
                                </li>
                                <li></li>
                                <li>
                                    <a href="javascript:" data-action="moveright" class="pull-right">
                                        <i class="icon-arrow-right icon-2x"></i>
                                    </a>
                                </li>
                                <li></li>
                                <li>
                                    <a href="javascript:" data-action="movedown">
                                        <i class="icon-arrow-down icon-2x"></i>
                                    </a>
                                </li>
                                <li></li>
                            </ul>
                        </div>

                    </div>
                    <div class="clear"></div>
                    <div style="display:block;text-align:center;margin:auto;">
                        <div id="box-canvas-wrapper" style="width:480px;height:580px;text-align:center;margin:auto;">
                            <canvas style="-moz-user-select: none; cursor: crosshair;" width="480" height="580" id="c1"></canvas>
                        </div>
                    </div>
                </div>
                <div id="box-alert" class="hide" style="height:20px;width:914px;position:absolute;background:none;border-radius: 0px;box-shadow: none;">
                    <p class="body" style="color:orange;padding:5px;background-color:white;"></p>
                </div>
                <div class="progress hide" style="height:10px;width:914px;position:absolute;background:none;border-radius: 0px;box-shadow: none;"><div class="bar bar-warning" id="progress-bar" style="width: 0%; height:8px;"></div></div>
                <div style="position:absolute;opacity: 0.8;" class="tools unselectable" id="box-toolbar-zoom">
                    <ul style="list-style:none;">
                        <li style="border-bottom:1px solid #333">
                            <a href="javascript:" data-action="remove" title="trash"><i class="icon-trash icon-2x"></i></a>
                        </li>
                        <li>
                            <a href="javascript:" data-action="backward" title="backword"><i class="icon-file-alt icon-2x"></i></a>
                        </li>
                        <li>
                            <a href="javascript:" data-action="forward" title="forward"><i class="icon-file icon-2x"></i></a>
                        </li>
                        
                        <li>
                            <a href="javascript:" data-action="lock" title="forward"><i class="icon-lock icon-2x"></i></a>
                        </li>
                        <li style="height:10px;"></li>
                        <li>
                            <a href="javascript:" data-action="zoomin"><i class="icon-zoom-in icon-2x"></i></a>
                        </li>
                        <li class="disabled">
                            <a href="javascript:" data-action="zoomout"><i class="icon-zoom-out icon-2x"></i></a>
                        </li>
                        <li class="disabled">
                            <a href="javascript:" data-action="zoomfit"><i class="icon-screenshot icon-2x"></i></a>
                        </li>
                        <li class="disabled">
                            <a href="javascript:"><i class="icon-undo icon-2x"></i></a>
                        </li>
                    </ul>
                </div>
                <div style="position:absolute;" class="tools unselectable hide" id="box-toolbar-bg">
                    <ul style="list-style:none;">
                        <li class="divider" id="li-backgroundcolor">
                            <a href="javascript:"><i class="icon-unchecked icon-2x"></i></a>
                            <ul class="hide" >
                                <li>
                                    <a href='javascript:' data-action="backgroundcolor" data-data="blue" style="background-color:blue;"></a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="backgroundcolor" data-data="red" style="background-color:red;"></a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="backgroundcolor" data-data="blue" style="background-color:blue;"></a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="backgroundcolor" data-data="red" style="background-color:red;"></a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="backgroundcolor" data-data="blue" style="background-color:blue;"></a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="backgroundcolor" data-data="red" style="background-color:red;"></a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="backgroundcolor" data-data="blue" style="background-color:blue;"></a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="backgroundcolor" data-data="red" style="background-color:red;"></a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="backgroundcolor" data-data="blue" style="background-color:blue;"></a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="backgroundcolor" data-data="red" style="background-color:red;"></a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="backgroundcolor" data-data="blue" style="background-color:blue;"></a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="backgroundcolor" data-data="red" style="background-color:red;"></a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="backgroundcolor" data-data="blue" style="background-color:blue;"></a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="backgroundcolor" data-data="red" style="background-color:red;"></a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="backgroundcolor" data-data="blue" style="background-color:blue;"></a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="backgroundcolor" data-data="red" style="background-color:red;"></a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="backgroundcolor" data-data="blue" style="background-color:blue;"></a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="backgroundcolor" data-data="red" style="background-color:red;"></a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="backgroundcolor" data-data="blue" style="background-color:blue;"></a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="backgroundcolor" data-data="red" style="background-color:red;"></a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="backgroundcolor" data-data="blue" style="background-color:blue;"></a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="backgroundcolor" data-data="red" style="background-color:red;"></a>
                                </li>
                                <li style="width:auto;" class="disabled">
                                    <input type="text"id="bg-color-picker" />
                                </li>
                            </ul>
                        </li>
                        <li class="divider">
                            <a href="javascript:" data-action="backgroundcolor" data-data="#ffffff"><i class="icon-trash icon-2x"></i></a>
                        </li>
                        <li>
                            <a href="javascript:" onclick="jQuery('#box-toolbar-bg').hide();"><i class="icon-ok icon-2x"></i></a>
                        </li>
                    </ul>
                </div>
                <div style="position:absolute;top:200px;" class="text-editor unselectable hide" id="box-toolbar-texteditor">
                    <ul style="list-style:none;">
                        <li class="divider" style='background-color:#eee'>
                            <a href="javascript:" data-action="backgroundcolor"><i class="icon-pencil icon-2x"></i></a>
                            <ul style='width:478px;height:150px;background-color:white;position:absolute;padding:10px;border:1px solid #ccc;display:block;left:-5px;'>
                                <li>
                                    <textarea style='width:455px;border:1px solid #ccc;height:140px;resize:none;border-radius: 0px;' id="text-content"></textarea>
                                </li>
                            </ul>
                        </li>
                        <li class="divider" id='li-font-type' >
                            <a href="javascript:" data-action="clearbackground"><i class="icon-font icon-2x"></i></a>
                            <ul>
                                <li title="American Typewriter" data-data="American Typewriter"><p style="background-position:10px 0px;font-family: American Typewriter">American Typewriter</p></li>
                                <li title="Daniel" data-data="Daniel"><p style="background-position:10px -20px;font-family: Daniel">Daniel</p></li>
                                <li title="League Gothic"><p style="background-position:10px -40px"></p></li>
                                <li title="Arial" class="selected"><p style="background-position:10px -60px"></p></li>
                                <li title="Georgia"><p style="background-position:10px -80px"></p></li>
                                <li title="Lobster"><p style="background-position:10px -100px"></p></li>
                                <li title="Bebas Nueue"><p style="background-position:10px -120px"></p></li>
                                <li title="Gill Sans"><p style="background-position:10px -140px"></p></li>
                                <li title="Optima"><p style="background-position:10px -160px"></p></li>
                                <li title="Bodoni"><p style="background-position:10px -180px"></p></li>
                                <li title="Gill Sans Light"><p style="background-position:10px -200px"></p></li>
                                <li title="Overlock"><p style="background-position:10px -220px"></p></li>
                                <li title="Bradley Hand"><p style="background-position:10px -240px"></p></li>
                                <li title="Gladifilthefte"><p style="background-position:10px -260px"></p></li>
                                <li title="Rockwell"><p style="background-position:10px -280px"></p></li>
                                <li title="Cartoonist Hand"><p style="background-position:10px -300px"></p></li>
                                <li title="Great Vibes"><p style="background-position:10px -320px"></p></li>
                                <li title="Sofia"><p style="background-position:10px -340px"></p></li>
                                <li title="ChunkFive"><p style="background-position:10px -360px"></p></li>
                                <li title="Helvetica Nueue Condensed"><p style="background-position:10px -380px"></p></li>
                                <li title="Tangerine"><p style="background-position:10px -400px"></p></li>
                                <li title="Clarendon"><p style="background-position:10px -420px"></p></li>
                                <li title="Helvetica Nueue Light"><p style="background-position:10px -440px"></p></li>
                                <li title="Times"><p style="background-position:10px -460px"></p></li>
                                <li title="Dancing Script"><p style="background-position:10px -480px"></p></li>
                            </ul>
                        </li>
                        <li class="divider" id='li-font-size'>
                            <a href="javascript:" data-action="backgroundcolor"><i class="icon-text-width icon-2x"></i></a>
                            <ul>
                                <li>
                                    <a href='javascript:' data-action="size" data-data="9">9</a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="size" data-data="10">10</a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="size" data-data="11">11</a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="size" data-data="12">12</a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="size" data-data="13">13</a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="size" data-data="14">14</a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="size" data-data="18">18</a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="size" data-data="24">24</a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="size" data-data="36">36</a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="size" data-data="48">48</a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="size" data-data="64">64</a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="size" data-data="72">72</a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="size" data-data="96">96</a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="size" data-data="144">144</a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="size" data-data="288">288</a>
                                </li>
                            </ul>
                        </li>
                        <li class="divider" id="li-font-color">
                            <a href="javascript:" data-action="clearbackground"><i class="icon-unchecked icon-2x"></i></a>
                            <ul>
                                <li>
                                    <a href='javascript:' data-action="color" data-data="blue" style="background-color:blue;"></a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="color" data-data="red" style="background-color:red;"></a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="color" data-data="blue" style="background-color:blue;"></a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="color" data-data="red" style="background-color:red;"></a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="color" data-data="blue" style="background-color:blue;"></a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="color" data-data="red" style="background-color:red;"></a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="color" data-data="blue" style="background-color:blue;"></a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="color" data-data="red" style="background-color:red;"></a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="color" data-data="blue" style="background-color:blue;"></a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="color" data-data="red" style="background-color:red;"></a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="color" data-data="blue" style="background-color:blue;"></a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="color" data-data="red" style="background-color:red;"></a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="color" data-data="blue" style="background-color:blue;"></a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="color" data-data="red" style="background-color:red;"></a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="color" data-data="blue" style="background-color:blue;"></a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="color" data-data="red" style="background-color:red;"></a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="color" data-data="blue" style="background-color:blue;"></a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="color" data-data="red" style="background-color:red;"></a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="color" data-data="blue" style="background-color:blue;"></a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="color" data-data="red" style="background-color:red;"></a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="color" data-data="blue" style="background-color:blue;"></a>
                                </li>
                                <li>
                                    <a href='javascript:' data-action="color" data-data="red" style="background-color:red;"></a>
                                </li>
                                <li style="width:auto;" class="disabled">
                                    <input type="text" id="font-color-picker" />
                                </li>
                            </ul>
                        </li>
                        <li class="divider">
                            <a href="javascript:" data-action="weight"><i class="icon-bold icon-2x"></i></a>
                        </li>
                        <li class="divider">
                            <a href="javascript:" data-action="italic"><i class="icon-italic icon-2x"></i></a>
                        </li>
                        <li class="divider">
                            <a href="javascript:" data-action="underline"><i class="icon-underline icon-2x"></i></a>
                        </li>
                        <li class="divider">
                            <a href="javascript:" data-action="align" data-data="left"><i class="icon-align-left icon-2x"></i></a>
                        </li>
                        <li class="divider">
                            <a href="javascript:" data-action="align" data-data="center"><i class="icon-align-center icon-2x"></i></a>
                        </li>
                        <li class="divider">
                            <a href="javascript:" data-action="align" data-data="right"><i class="icon-align-right icon-2x"></i></a>
                        </li>
                        <li class="divider hide">
                            <a href="javascript:" data-action="backgroundcolor"><i class="icon-caret-left icon-2x"></i></a>
                        </li>
                        <li class="divider hide">
                            <a href="javascript:" data-action="clearbackground"><i class="icon-file-alt icon-2x"></i></a>
                        </li>
                        <li class="divider hide">
                            <a href="javascript:" data-action="backgroundcolor"><i class="icon-trash icon-2x"></i></a>
                        </li>
                        <li>
                            <a href="javascript:" data-action="confirm"><i class="icon-ok icon-2x"></i></a>
                        </li>
                        <li>
                            <a href="javascript:" data-action="close"><i class="icon-remove icon-2x"></i></a>
                        </li>
                    </ul>
                </div>
            </div>
            <!-- editor -->

        </div>
        <!-- end fluid-container -->

        <!-- plupload -->
        <script type="text/javascript" src="http://bp.yahooapis.com/2.4.21/browserplus-min.js"></script>

        <script type="text/javascript" src="js/pluploader/plupload.js"></script>
        <script type="text/javascript" src="js/pluploader/plupload.gears.js"></script>
        <script type="text/javascript" src="js/pluploader/plupload.silverlight.js"></script>
        <script type="text/javascript" src="js/pluploader/plupload.flash.js"></script>
        <script type="text/javascript" src="js/pluploader/plupload.browserplus.js"></script>
        <script type="text/javascript" src="js/pluploader/plupload.html4.js"></script>
        <script type="text/javascript" src="js/pluploader/plupload.html5.js"></script>
        <script type="text/javascript">
            function PL(id) {
                return document.getElementById(id);
            }

            var uploader = new plupload.Uploader({
                runtimes: 'gears,html5,browserplus',
                browse_button: 'btn-upload-image',
                container: 'uploader',
                max_file_size: '10mb',
                url: 'process/index.php?action=upload',
                multi_selection: false,
                //resize: {width: 640, height: 240, quality: 100},
                //flash_swf_url: 'js/uploader/plupload.flash.swf',
                //silverlight_xap_url : 'js/uploader/plupload.silverlight.xap',
                filters: [
                    {title: "Image Files", extensions: "png,jpeg,jpg,gif"}
                ]
            });

            uploader.bind('Init', function(up, params) {
                //$('filelist').innerHTML = "<div>Current runtime: " + params.runtime + "</div>";
            });

            uploader.init();

            uploader.bind('FilesAdded', function(up, files) {

                if (uploader.files.length == 2) {
                    uploader.removeFile(uploader.files[0]);
                }

                for (var i in files) {
                    //document.getElementById('filelist').innerHTML = '<div id="' + files[i].id + '">' + files[i].name + ' (' + plupload.formatSize(files[i].size) + ') <b></b></div>';
                }
                
                jQuery('#progress-bar').css('width', "0%");
                $("#progress-bar").parent().show ();
                uploader.start();
            });

            uploader.bind('UploadProgress', function(up, file) {
                //$(file.id).getElementsByTagName('b')[0].innerHTML = '<span>' + file.percent + "%</span>";
                jQuery('#progress-bar').css('width', file.percent + "%");

            });

            uploader.bind('FileUploaded', function(up, file, response) {
                plupload.each(response, function(value, key) {

                    if (key == "response") {
                        try {
                            var result = jQuery.parseJSON(value);
                            if (result.error == 0) {
                                //showAlert2("Loading image....");
                                $("#progress-bar").css ("width", "0px");
                                $("#progress-bar").parent().hide ();
                                showAlert2 ("Loading image......");
                                $.mememaker.tools.addpic(result.files.url);
                            }
                        }
                        catch (e) {
                            console.log (e);
                        }
                        //jQuery('#progress-bar').css('width', "0%");
                    }
                });

                //alert($.parseJSON(response.response).result);
            });

        </script>

        <script type="text/javascript">
            jQuery(document).ready(
                    function() {

                        $(window).on('beforeunload', function() {
                            //return 'Are you sure you want to leave? Your design isn\'t saved yet.';
                        });

                        maker_init();;

                    }
            );

            function maker_init()
            {
                
                $.mememakerinit.init('c1', "#FFFFFF");
                $.mememakerinit.toolsinit(".tools");

                $.mememakerinit.texteditorinit(".text-editor");
                $.mememakerinit.imageeditorinit(".image-editor");
                $.mememakerinit.draweditorinit(".draw-editor");

                //
                $.mememaker.tools.preview_callback = preview;
                $.mememaker.tools.save_callback = save_canvas;
                //$.mememaker.tools.backgroundcolor("red");

                //$(".upper-canvas").css ("left", "20px");
                //templatelist_load();

                if ($("#canvas_guid").data('reload') == "1") {
                    reload_canvas();
                }

                // display all buttons after canvas loaded


            }

            //===========================================================
            // Server API
            //===========================================================

            function save_canvas(json)
            {
                var id = $("#canvas_guid").val();
                var name = $("#current-item").data('name');
                var guid = $("#current-item").val();

                if ($("#current-item").val() == "") {
                    alert("You don't have to save an empty canvas.");
                    return false;
                }

                jQuery.ajax({
                    url: "" + id,
                    data: {'json': json, 'name': name, 'product': guid},
                    type: "POST",
                    beforeSend: function(xhr) {

                    }
                }).done(function(data) {

                    var result = $.parseJSON(data);
                    if (result.error == 1) {
                        $("#modal-user").modal();
                        formuser_load();
                    } else {
                        $("#canvas_guid").val(result.data.guid);
                        $("#canvas_guid").data('saved', '1');
                        alert("Your progress just saved");
                    }

                }).fail(function() {
                    //$("#template-list").prev().children(":first-child").hide(0);
                });
            }

            function reload_canvas()
            {
                var guid = $("#canvas_guid").val();

                jQuery.ajax({
                    url: "",
                    data: {'guid': guid},
                    type: "POST",
                    beforeSend: function(xhr) {

                    }
                }).done(function(data) {

                    //console.log (data);
                    var result = $.parseJSON(data);
                    //console.log(data);

                    if (result.error == 1) {

                    } else {
                        //console.log (result.data.json);
                        $("#current-item").data('name', result.data.name);
                        $("#current-item").val(result.data.product);
                        $.mememaker.reload(result.data.json);
                    }

                }).fail(function() {
                    //$("#template-list").prev().children(":first-child").hide(0);
                });
            }

            //===========================================================
            // Server API
            //===========================================================
            function templatelist_load()
            {
                jQuery.ajax({
                    url: "",
                    type: "GET",
                    beforeSend: function(xhr) {

                    }
                }).done(function(data) {

                    $("#box-template-list").html(data);
                    templatelist_config();

                }).fail(function() {
                    //$("#template-list").prev().children(":first-child").hide(0);
                });
            }

            function templatelist_config() {

                jQuery("#template-list a").off('click');
                jQuery("#template-list a").click(
                        function() {

                            var bg = $(this).data('bg');
                            var fg = $(this).data('fg');

                            //$.mememaker.tools.backgroundimage(bg);
                            $.mememaker.tools.newtemplate(fg);
                            $.mememaker.tools.backgroundcolor("#DDDDDD");

                            $("#current-item").val($(this).data('guid'));
                            $("#current-item").data('name', $(this).data('name'));
                            $.shoppingcart.setCurrentProductId($(this).data('guid'));
                            $("#btn-order span").text("Order Now " + $(this).data('price') + "$");
                        }
                );
            }

            //==================================================================
            // order
            //==================================================================            

            function order_config() {
                jQuery("#btn-cart").click(
                        function() {

                            var orderId = null;
                            orderId = jQuery("#modal-preview #product-info").data('guid');
                            var image = jQuery("#modal-preview #product-info").data('file');

                            $.shoppingcart.set(orderId + "-" + image);

                            jQuery("#modal-preview").modal('hide');

                            window.open("", "_blank");
                            window.focus();
                        }
                )
            }

            function order()
            {
                if (jQuery.trim(jQuery("#current-item").val()) == "") {
                    return;
                }
                $.mememaker.tools.preview(preview);
                return;
            }

            function preview(preview)
            {
                if (jQuery.trim(jQuery("#current-item").val()) == "") {
                    return;
                }
                jQuery("#modal-preview .modal-body").html('<div class="ajax-loading-indicator hide" style=""><a href="javascript:" style="font-size:14px;"><i class="icon-refresh icon-spin"></i> Loading ....</a></div>');
                jQuery(".ajax-loading-indicator").show(0);
                jQuery("#modal-preview").modal();

                jQuery.ajax({
                    url: "",
                    data: {"image-extension": "jpeg", "image-data": preview, "user": $.shoppingcart.getuuid(), "product": jQuery("#current-item").val()},
                    type: "POST",
                    beforeSend: function(xhr) {
                    }
                }).done(function(data) {
                    jQuery(".ajax-loading-indicator").hide(0);
                    jQuery("#modal-preview .modal-body").html(data);
                    order_config();
                    order_current();

                }).fail(function() {
                    jQuery(".ajax-loading-indicator").hide(0);
                });
            }

            function order_current()
            {
                var orderId = null;
                orderId = jQuery("#modal-preview #product-info").data('guid');
                var image = jQuery("#modal-preview #product-info").data('file');

                $.shoppingcart.setCurrentProductId(orderId + "-" + image);
                return true;
            }

            //===================================================

            function formuser_load()
            {
                jQuery.ajax({
                    url: "",
                    type: "GET",
                    beforeSend: function(xhr) {
                    }
                }).done(function(data) {

                    $("#modal-user .modal-body").html(data);

                }).fail(function() {
                    jQuery(".ajax-loading-indicator").hide(0);
                });
            }

            function signup_submit()
            {
                jQuery.ajax({
                    url: "",
                    data: $("#form-signup").serialize(),
                    type: "POST",
                    beforeSend: function(xhr) {
                        $("#btn-signup").button("loading");
                    }
                }).done(function(data) {
                    $("#btn-signup").button("reset");

                    var result = $.parseJSON(data);
                    if (result.error == 1) {
                        $("#form-signup .text-error").html(result.message);
                    } else {
                        $("#modal-user").modal('hide');
                        alert("Now click 'save'to save your progress");
                    }
                }).fail(function() {
                });
            }

            function signin_submit()
            {
                jQuery.ajax({
                    url: "",
                    data: $("#form-signin").serialize(),
                    type: "POST",
                    beforeSend: function(xhr) {
                        $("#btn-signin").button("loading");
                    }
                }).done(function(data) {
                    $("#btn-signin").button("reset");

                    var result = $.parseJSON(data);
                    if (result.error == 1) {
                        $("#form-signin .text-error").html(result.message);
                    } else {
                        $("#modal-user").modal('hide');
                        alert("Now click 'save'to save your progress");
                    }
                }).fail(function() {
                });
            }

        </script>
        
        <script>
            function showAlert(message)
            {
                $("#box-alert .body").html(message);
                $("#box-alert").show();
                window.setTimeout(function() {
                    $("#box-alert").hide(100)
                }, 5000);
            }

            function showAlert2(message)
            {
                $("#box-alert .body").html(message);
                $("#box-alert").show();
            }

            function hideAlert(message)
            {
                $("#box-alert").hide();
            }
        </script>

        <!-- preview modal -->
        <div id="modal-preview" class="modal hide" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h3 id="myModalLabel">Your Design</h3>
            </div>
            <div class="modal-body">
                <div class="ajax-loading-indicator hide" style=""><a href="javascript:" style="font-size:14px;"><i class="icon-refresh icon-spin"></i> Loading ....</a></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>

        <!-- user modal -->
        <div id="modal-user" class="modal hide" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h3 id="myModalLabel">User</h3>
            </div>
            <div class="modal-body">
                <div class="ajax-loading-indicator hide" style=""><a href="javascript:" style="font-size:14px;"><i class="icon-refresh icon-spin"></i> Loading ....</a></div>
            </div>
            <div class="modal-footer">
                <p class="text-error">You have to sign in to save your progress.</p>
            </div>
        </div>
        
        <!-- user modal -->
        <div id="modal-upload-progress" class="modal hide" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-body">
            </div>
        </div>

        <!-- footer -->

        <hr />
        <footer>
            <h5>&nbsp;&nbsp;@By <a href="http://github.com/hellomaya" target="_blank">HelloMaya </a><span class="pull-right">&nbsp;&nbsp;</span><span class="pull-right">IE9+,Google Chrome,Safari,Firefox Compatiable</span></h5>
        </footer>

        <script src="js/vendor/bootstrap.min.js"></script>

        <script src="js/plugins.js"></script>
        <script src="js/main.js"></script>
        <script src='js/spectrum/spectrum.js'></script>
        <link rel='stylesheet' href='js/spectrum/spectrum.css' />
        <!-- bootstrap slider -->
<!--        <link rel="stylesheet" href="js/inputslider/css/slider.css" media="screen" type="text/css" />
        <script type="text/javascript" src="js/inputslider/js/bootstrap-slider.js"></script>-->
        <!-- colorpicker -->
        <!--        <script type="text/javascript" src="js/colorpicker2/js/bootstrap-colorpicker.js"></script>
                <script type="text/javascript" src="js/colorpicker2/js/docs.js"></script>-->
        <!-- fabric.js -->
<!--        <script src="http://cdnjs.cloudflare.com/ajax/libs/fabric.js/1.2.0/fabric.all.min.js"></script>-->
        <script>window.fabric || document.write('<script src="js/maker/fabric.all.min.js"><\/script>')</script> 
        <script src="js/maker/jquery.mememaker.js"></script>
        <script src="js/maker/jquery.mememakerinit.js"></script>
        
    </body>
</html>
